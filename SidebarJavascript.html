<script>
  // Function to fetch available currencies from Frankfurter API and update dropdowns alphabetically
  function updateCurrencyDropdowns() {
    google.script.run.withSuccessHandler(function (currencies) {
      var fromDropdown = document.getElementById('fromCurrency');
      var toDropdown = document.getElementById('toCurrency');

      // Clear existing options
      fromDropdown.innerHTML = '';
      toDropdown.innerHTML = '';

      // Get the currency codes and sort them alphabetically
      var currencyCodes = Object.keys(currencies).sort();

      let defaultCurrency = 'USD';

      // Populate the dropdowns with the currencies in alphabetical order
      currencyCodes.forEach(function (code) {
        var flagEmoji = currencyFlags[code] ? currencyFlags[code] + ' ' : '';
        var option = document.createElement('option');
        option.value = code;
        option.text = flagEmoji + currencies[code] + ' (' + code + ')';
        if (code == defaultCurrency) option.selected = "selected";
        fromDropdown.appendChild(option.cloneNode(true));
        toDropdown.appendChild(option);
      });
    }).getCurrencies();
  }

  // Call the function to update the dropdowns
  updateCurrencyDropdowns();

  function switchCurrencies() {
    var fromDropdown = document.getElementById('fromCurrency');
    var toDropdown = document.getElementById('toCurrency');
    // Swapping the values of the dropdowns
    var temp = fromDropdown.value;
    fromDropdown.value = toDropdown.value;
    toDropdown.value = temp;
  }

  function convert() {
    var fromCurrency = document.getElementById('fromCurrency').value;
    var toCurrency = document.getElementById('toCurrency').value;
    var convertEntireSheet = document.getElementById('convertEntireSheet').checked;
    google.script.run.convertCurrencyInSelectedRange(fromCurrency, toCurrency, convertEntireSheet);
  }

  const currencyFlags = {
    "'AFN': 'ğŸ‡¦ğŸ‡«', 
    'ALL': 'ğŸ‡¦ğŸ‡±',
    'DZD': 'ğŸ‡©ğŸ‡¿',
    'ANG': 'ğŸ‡¨ğŸ‡¼',
    'ANG': 'ğŸ‡¸ğŸ‡½',
    'AOA': 'ğŸ‡¦ğŸ‡´',
    'AUD': 'ğŸ‡¦ğŸ‡º',
    'AUD': 'ğŸ‡¨ğŸ‡½',
    'ARS': 'ğŸ‡¦ğŸ‡·',
    'AMD': 'ğŸ‡¦ğŸ‡²',
    'AWG': 'ğŸ‡¦ğŸ‡¼',
    'AUD': 'ğŸ‡¨ğŸ‡¨',
    'AUD': 'ğŸ‡­ğŸ‡²',
    'AZN': 'ğŸ‡¦ğŸ‡¿',
    'BSD': 'ğŸ‡§ğŸ‡¸',
    'BHD': 'ğŸ‡§ğŸ‡­',
    'BDT': 'ğŸ‡§ğŸ‡©',
    'BBD': 'ğŸ‡§ğŸ‡§',
    'BYN': 'ğŸ‡§ğŸ‡¾',
    'AUD': 'ğŸ‡°ğŸ‡®',
    'BZD': 'ğŸ‡§ğŸ‡¿',
    'AUD': 'ğŸ‡³ğŸ‡·',
    'BMD': 'ğŸ‡§ğŸ‡²',
    'BTN': 'ğŸ‡§ğŸ‡¹',
    'AUD': 'ğŸ‡³ğŸ‡«',
    'BOB': 'ğŸ‡§ğŸ‡´',
    'BOV': 'ğŸ‡§ğŸ‡´',
    'AUD': 'ğŸ‡¹ğŸ‡»',
    'BAM': 'ğŸ‡§ğŸ‡¦',
    'BWP': 'ğŸ‡§ğŸ‡¼',
    'CHF': 'ğŸ‡±ğŸ‡®',
    'BRL': 'ğŸ‡§ğŸ‡·',
    'CHF': 'ğŸ‡¨ğŸ‡­',
    'BND': 'ğŸ‡§ğŸ‡³',
    'BGN': 'ğŸ‡§ğŸ‡¬',
    'DKK': 'ğŸ‡©ğŸ‡°',
    'BIF': 'ğŸ‡§ğŸ‡®',
    'CVE': 'ğŸ‡¨ğŸ‡»',
    'KHR': 'ğŸ‡°ğŸ‡­',
    'DKK': 'ğŸ‡«ğŸ‡´',
    'CAD': 'ğŸ‡¨ğŸ‡¦',
    'KYD': 'ğŸ‡°ğŸ‡¾',
    'DKK': 'ğŸ‡¬ğŸ‡±',
    'EUR': 'ğŸ‡¦ğŸ‡©',
    'CLF': 'ğŸ‡¨ğŸ‡±',
    'CLP': 'ğŸ‡¨ğŸ‡±',
    'CNY': 'ğŸ‡¨ğŸ‡³',
    'EUR': 'ğŸ‡¦ğŸ‡¹',
    'EUR': 'ğŸ‡§ğŸ‡ª',
    'COP': 'ğŸ‡¨ğŸ‡´',
    'COU': 'ğŸ‡¨ğŸ‡´',
    'KMF': 'ğŸ‡°ğŸ‡²',
    'CDF': 'ğŸ‡¨ğŸ‡©',
    'EUR': 'ğŸ‡­ğŸ‡·',
    'EUR': 'ğŸ‡¨ğŸ‡¾',
    'CRC': 'ğŸ‡¨ğŸ‡·',
    'EUR': 'ğŸ‡ªğŸ‡ª',
    'CUC': 'ğŸ‡¨ğŸ‡º',
    'CUP': 'ğŸ‡¨ğŸ‡º',
    'EUR': 'ğŸ‡ªğŸ‡º',
    'EUR': 'ğŸ‡«ğŸ‡®',
    'CZK': 'ğŸ‡¨ğŸ‡¿',
    'EUR': 'ğŸ‡«ğŸ‡·',
    'EUR': 'ğŸ‡¬ğŸ‡«',
    'DJF': 'ğŸ‡©ğŸ‡¯',
    'EUR': 'ğŸ‡¹ğŸ‡«',
    'DOP': 'ğŸ‡©ğŸ‡´',
    'EUR': 'ğŸ‡©ğŸ‡ª',
    'EGP': 'ğŸ‡ªğŸ‡¬',
    'SVC': 'ğŸ‡¸ğŸ‡»',
    'EUR': 'ğŸ‡¬ğŸ‡·',
    'EUR': 'ğŸ‡¬ğŸ‡µ',
    'ERN': 'ğŸ‡ªğŸ‡·',
    'EUR': 'ğŸ‡»ğŸ‡¦',
    'ETB': 'ğŸ‡ªğŸ‡¹',
    'EUR': 'ğŸ‡®ğŸ‡ª',
    'FKP': 'ğŸ‡«ğŸ‡°',
    'EUR': 'ğŸ‡®ğŸ‡¹',
    'FJD': 'ğŸ‡«ğŸ‡¯',
    'EUR': 'ğŸ‡±ğŸ‡»',
    'EUR': 'ğŸ‡±ğŸ‡¹',
    'EUR': 'ğŸ‡±ğŸ‡º',
    'EUR': 'ğŸ‡²ğŸ‡¹',
    'EUR': 'ğŸ‡²ğŸ‡¶',
    'EUR': 'ğŸ‡¾ğŸ‡¹',
    'GMD': 'ğŸ‡¬ğŸ‡²',
    'GEL': 'ğŸ‡¬ğŸ‡ª',
    'EUR': 'ğŸ‡²ğŸ‡¨',
    'GHS': 'ğŸ‡¬ğŸ‡­',
    'GIP': 'ğŸ‡¬ğŸ‡®',
    'EUR': 'ğŸ‡²ğŸ‡ª',
    'EUR': 'ğŸ‡³ğŸ‡±',
    'EUR': 'ğŸ‡µğŸ‡¹',
    'EUR': 'ğŸ‡·ğŸ‡ª',
    'EUR': 'ğŸ‡§ğŸ‡±',
    'GTQ': 'ğŸ‡¬ğŸ‡¹',
    'EUR': 'ğŸ‡²ğŸ‡«',
    'GNF': 'ğŸ‡¬ğŸ‡³',
    'EUR': 'ğŸ‡µğŸ‡²',
    'GYD': 'ğŸ‡¬ğŸ‡¾',
    'HTG': 'ğŸ‡­ğŸ‡¹',
    'EUR': 'ğŸ‡¸ğŸ‡²',
    'EUR': 'ğŸ‡¸ğŸ‡°',
    'EUR': 'ğŸ‡¸ğŸ‡®',
    'HNL': 'ğŸ‡­ğŸ‡³',
    'HKD': 'ğŸ‡­ğŸ‡°',
    'HUF': 'ğŸ‡­ğŸ‡º',
    'ISK': 'ğŸ‡®ğŸ‡¸',
    'EUR': 'ğŸ‡ªğŸ‡¸',
    'IDR': 'ğŸ‡®ğŸ‡©',
    'IRR': 'ğŸ‡®ğŸ‡·',
    'IQD': 'ğŸ‡®ğŸ‡¶',
    'EUR': 'ğŸ‡¦ğŸ‡½',
    'GBP': 'ğŸ‡¬ğŸ‡¬',
    'ILS': 'ğŸ‡®ğŸ‡±',
    'GBP': 'ğŸ‡®ğŸ‡²',
    'JMD': 'ğŸ‡¯ğŸ‡²',
    'JPY': 'ğŸ‡¯ğŸ‡µ',
    'GBP': 'ğŸ‡¯ğŸ‡ª',
    'JOD': 'ğŸ‡¯ğŸ‡´',
    'KZT': 'ğŸ‡°ğŸ‡¿',
    'KES': 'ğŸ‡°ğŸ‡ª',
    'GBP': 'ğŸ‡¬ğŸ‡§',
    'KPW': 'ğŸ‡°ğŸ‡µ',
    'KRW': 'ğŸ‡°ğŸ‡·',
    'KWD': 'ğŸ‡°ğŸ‡¼',
    'KGS': 'ğŸ‡°ğŸ‡¬',
    'LAK': 'ğŸ‡±ğŸ‡¦',
    'INR': 'ğŸ‡§ğŸ‡¹',
    'LBP': 'ğŸ‡±ğŸ‡§',
    'LSL': 'ğŸ‡±ğŸ‡¸',
    'INR': 'ğŸ‡®ğŸ‡³',
    'LRD': 'ğŸ‡±ğŸ‡·',
    'LYD': 'ğŸ‡±ğŸ‡¾',
    'MAD': 'ğŸ‡²ğŸ‡¦',
    'MAD': 'ğŸ‡ªğŸ‡­',
    'NOK': 'ğŸ‡§ğŸ‡»',
    'MOP': 'ğŸ‡²ğŸ‡´',
    'MGA': 'ğŸ‡²ğŸ‡¬',
    'MWK': 'ğŸ‡²ğŸ‡¼',
    'MYR': 'ğŸ‡²ğŸ‡¾',
    'MVR': 'ğŸ‡²ğŸ‡»',
    'NOK': 'ğŸ‡³ğŸ‡´',
    'NOK': 'ğŸ‡¸ğŸ‡¯',
    'NZD': 'ğŸ‡¨ğŸ‡°',
    'NZD': 'ğŸ‡³ğŸ‡¿',
    'MRU': 'ğŸ‡²ğŸ‡·',
    'MUR': 'ğŸ‡²ğŸ‡º',
    'NZD': 'ğŸ‡³ğŸ‡º',
    'MXN': 'ğŸ‡²ğŸ‡½',
    'MXV': 'ğŸ‡²ğŸ‡½',
    'NZD': 'ğŸ‡µğŸ‡³',
    'MDL': 'ğŸ‡²ğŸ‡©',
    'NZD': 'ğŸ‡¹ğŸ‡°',
    'MNT': 'ğŸ‡²ğŸ‡³',
    'USD': 'ğŸ‡¦ğŸ‡¸',
    'USD': 'ğŸ‡§ğŸ‡¶',
    'USD': 'ğŸ‡®ğŸ‡´',
    'MZN': 'ğŸ‡²ğŸ‡¿',
    'MMK': 'ğŸ‡²ğŸ‡²',
    'NAD': 'ğŸ‡³ğŸ‡¦',
    'USD': 'ğŸ‡ªğŸ‡¨',
    'USD': 'ğŸ‡¸ğŸ‡»',
    'NPR': 'ğŸ‡³ğŸ‡µ',
    'USD': 'ğŸ‡¬ğŸ‡º',
    'USD': 'ğŸ‡­ğŸ‡¹',
    'USD': 'ğŸ‡²ğŸ‡­',
    'NIO': 'ğŸ‡³ğŸ‡®',
    'USD': 'ğŸ‡«ğŸ‡²',
    'NGN': 'ğŸ‡³ğŸ‡¬',
    'USD': 'ğŸ‡²ğŸ‡µ',
    'USD': 'ğŸ‡µğŸ‡¼',
    'USD': 'ğŸ‡µğŸ‡¦',
    'USD': 'ğŸ‡µğŸ‡·',
    'OMR': 'ğŸ‡´ğŸ‡²',
    'PKR': 'ğŸ‡µğŸ‡°',
    'USD': 'ğŸ‡¹ğŸ‡±',
    'PAB': 'ğŸ‡µğŸ‡¦',
    'USD': 'ğŸ‡¹ğŸ‡¨',
    'PGK': 'ğŸ‡µğŸ‡¬',
    'PYG': 'ğŸ‡µğŸ‡¾',
    'PEN': 'ğŸ‡µğŸ‡ª',
    'PHP': 'ğŸ‡µğŸ‡­',
    'USD': 'ğŸ‡ºğŸ‡²',
    'PLN': 'ğŸ‡µğŸ‡±',
    'USD': 'ğŸ‡ºğŸ‡¸',
    'USD': 'ğŸ‡»ğŸ‡¬',
    'QAR': 'ğŸ‡¶ğŸ‡¦',
    'MKD': 'ğŸ‡²ğŸ‡°',
    'RON': 'ğŸ‡·ğŸ‡´',
    'RUB': 'ğŸ‡·ğŸ‡º',
    'RWF': 'ğŸ‡·ğŸ‡¼',
    'USD': 'ğŸ‡»ğŸ‡®',
    'XAF': 'ğŸ‡¨ğŸ‡²',
    'SHP': 'ğŸ‡¸ğŸ‡­',
    'XAF': 'ğŸ‡¨ğŸ‡«',
    'XAF': 'ğŸ‡¹ğŸ‡©',
    'XAF': 'ğŸ‡¨ğŸ‡©',
    'XAF': 'ğŸ‡¬ğŸ‡¶',
    'XAF': 'ğŸ‡¬ğŸ‡¦',
    'WST': 'ğŸ‡¼ğŸ‡¸',
    'XCD': 'ğŸ‡¦ğŸ‡®',
    'STN': 'ğŸ‡¸ğŸ‡¹',
    'SAR': 'ğŸ‡¸ğŸ‡¦',
    'XCD': 'ğŸ‡¦ğŸ‡¬',
    'RSD': 'ğŸ‡·ğŸ‡¸',
    'SCR': 'ğŸ‡¸ğŸ‡¨',
    'SLE': 'ğŸ‡¸ğŸ‡±',
    'SGD': 'ğŸ‡¸ğŸ‡¬',
    'XCD': 'ğŸ‡©ğŸ‡²',
    'XCD': 'ğŸ‡¬ğŸ‡©',
    'XCD': 'ğŸ‡²ğŸ‡¸',
    'SBD': 'ğŸ‡¸ğŸ‡§',
    'SOS': 'ğŸ‡¸ğŸ‡´',
    'XCD': 'ğŸ‡°ğŸ‡³',
    'SSP': 'ğŸ‡¸ğŸ‡¸',
    'XCD': 'ğŸ‡±ğŸ‡¨',
    'LKR': 'ğŸ‡±ğŸ‡°',
    'SDG': 'ğŸ‡¸ğŸ‡©',
    'SRD': 'ğŸ‡¸ğŸ‡·',
    'XCD': 'ğŸ‡»ğŸ‡¨',
    'SZL': 'ğŸ‡¸ğŸ‡¿',
    'SEK': 'ğŸ‡¸ğŸ‡ª',
    'CHE': 'ğŸ‡¨ğŸ‡­',
    'XOF': 'ğŸ‡§ğŸ‡¯',
    'CHW': 'ğŸ‡¨ğŸ‡­',
    'SYP': 'ğŸ‡¸ğŸ‡¾',
    'TWD': 'ğŸ‡¹ğŸ‡¼',
    'TJS': 'ğŸ‡¹ğŸ‡¯',
    'TZS': 'ğŸ‡¹ğŸ‡¿',
    'THB': 'ğŸ‡¹ğŸ‡­',
    'XOF': 'ğŸ‡§ğŸ‡«',
    'XOF': 'ğŸ‡¨ğŸ‡®',
    'XOF': 'ğŸ‡¬ğŸ‡¼',
    'TOP': 'ğŸ‡¹ğŸ‡´',
    'TTD': 'ğŸ‡¹ğŸ‡¹',
    'TND': 'ğŸ‡¹ğŸ‡³',
    'TRY': 'ğŸ‡¹ğŸ‡·',
    'TMT': 'ğŸ‡¹ğŸ‡²',
    'XOF': 'ğŸ‡²ğŸ‡±',
    'XOF': 'ğŸ‡³ğŸ‡ª',
    'UGX': 'ğŸ‡ºğŸ‡¬',
    'UAH': 'ğŸ‡ºğŸ‡¦',
    'AED': 'ğŸ‡¦ğŸ‡ª',
    'XOF': 'ğŸ‡¸ğŸ‡³',
    'XOF': 'ğŸ‡¹ğŸ‡¬',
    'XPF': 'ğŸ‡µğŸ‡«',
    'USN': 'ğŸ‡ºğŸ‡¸',
    'UYI': 'ğŸ‡ºğŸ‡¾',
    'UYU': 'ğŸ‡ºğŸ‡¾',
    'UZS': 'ğŸ‡ºğŸ‡¿',
    'VUV': 'ğŸ‡»ğŸ‡º',
    'VEF': 'ğŸ‡»ğŸ‡ª',
    'VED': 'ğŸ‡»ğŸ‡ª',
    'VND': 'ğŸ‡»ğŸ‡³',
    'XPF': 'ğŸ‡³ğŸ‡¨',
    'XPF': 'ğŸ‡¼ğŸ‡«',
    'ZAR': 'ğŸ‡±ğŸ‡¸',
    'ZAR': 'ğŸ‡³ğŸ‡¦',
    'YER': 'ğŸ‡¾ğŸ‡ª',
    'ZMW': 'ğŸ‡¿ğŸ‡²',
    'ZWL': 'ğŸ‡¿ğŸ‡¼',
    'ZAR': 'ğŸ‡¿ğŸ‡¦'"
        };
</script>