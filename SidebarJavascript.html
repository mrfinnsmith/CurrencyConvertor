<script>
  // Function to fetch available currencies from Frankfurter API and update dropdowns alphabetically
  function updateCurrencyDropdowns() {
google.script.run.withSuccessHandler(function(currencies) {
  var fromDropdown = document.getElementById('fromCurrency');
  var toDropdown = document.getElementById('toCurrency');

  // Clear existing options
  fromDropdown.innerHTML = '';
  toDropdown.innerHTML = '';

  // Get the currency codes and sort them alphabetically
  var currencyCodes = Object.keys(currencies).sort();

  let defaultCurrency = 'USD';

  // Populate the dropdowns with the currencies in alphabetical order
  currencyCodes.forEach(function(code) {
    var flagEmoji = currencyFlags[code] ? currencyFlags[code] + ' ' : '';
    var option = document.createElement('option');
    option.value = code;
    option.text =  currencies[code] + ' (' + code + ') ' + flagEmoji;
    if (code == defaultCurrency) option.selected = "selected";
    fromDropdown.appendChild(option.cloneNode(true));
    toDropdown.appendChild(option);
  });
}).getCurrencies();
}

  // Call the function to update the dropdowns
updateCurrencyDropdowns();

  function switchCurrencies() {
    var fromDropdown = document.getElementById('fromCurrency');
    var toDropdown = document.getElementById('toCurrency');
    // Swapping the values of the dropdowns
    var temp = fromDropdown.value;
    fromDropdown.value = toDropdown.value;
    toDropdown.value = temp;
  }

  function convert() {
    var fromCurrency = document.getElementById('fromCurrency').value;
    var toCurrency = document.getElementById('toCurrency').value;
    var convertEntireSheet = document.getElementById('convertEntireSheet').checked;
    var conversionType = document.querySelector('input[name="conversionType"]:checked').value;
    
    google.script.run.convertCurrencyInSelectedRange(fromCurrency, toCurrency, convertEntireSheet, conversionType);
  }

const currencyFlags = {
  'AFN': 'ğŸ‡¦ğŸ‡«',
  'ALL': 'ğŸ‡¦ğŸ‡±',
  'DZD': 'ğŸ‡©ğŸ‡¿',
  'AOA': 'ğŸ‡¦ğŸ‡´',
  'AUD': 'ğŸ‡¦ğŸ‡º',
  'ARS': 'ğŸ‡¦ğŸ‡·',
  'AMD': 'ğŸ‡¦ğŸ‡²',
  'AWG': 'ğŸ‡¦ğŸ‡¼',
  'AZN': 'ğŸ‡¦ğŸ‡¿',
  'BSD': 'ğŸ‡§ğŸ‡¸',
  'BHD': 'ğŸ‡§ğŸ‡­',
  'BDT': 'ğŸ‡§ğŸ‡©',
  'BBD': 'ğŸ‡§ğŸ‡§',
  'BYN': 'ğŸ‡§ğŸ‡¾',
  'BZD': 'ğŸ‡§ğŸ‡¿',
  'BMD': 'ğŸ‡§ğŸ‡²',
  'BTN': 'ğŸ‡§ğŸ‡¹',
  'BOB': 'ğŸ‡§ğŸ‡´',
  'BOV': 'ğŸ‡§ğŸ‡´',
  'BAM': 'ğŸ‡§ğŸ‡¦',
  'BWP': 'ğŸ‡§ğŸ‡¼',
  'BRL': 'ğŸ‡§ğŸ‡·',
  'CHF': 'ğŸ‡¨ğŸ‡­',
  'BND': 'ğŸ‡§ğŸ‡³',
  'BGN': 'ğŸ‡§ğŸ‡¬',
  'DKK': 'ğŸ‡©ğŸ‡°',
  'BIF': 'ğŸ‡§ğŸ‡®',
  'CVE': 'ğŸ‡¨ğŸ‡»',
  'KHR': 'ğŸ‡°ğŸ‡­',
  'CAD': 'ğŸ‡¨ğŸ‡¦',
  'KYD': 'ğŸ‡°ğŸ‡¾',
  'CLF': 'ğŸ‡¨ğŸ‡±',
  'CLP': 'ğŸ‡¨ğŸ‡±',
  'CNY': 'ğŸ‡¨ğŸ‡³',
  'COP': 'ğŸ‡¨ğŸ‡´',
  'COU': 'ğŸ‡¨ğŸ‡´',
  'KMF': 'ğŸ‡°ğŸ‡²',
  'CDF': 'ğŸ‡¨ğŸ‡©',
  'CRC': 'ğŸ‡¨ğŸ‡·',
  'CUC': 'ğŸ‡¨ğŸ‡º',
  'CUP': 'ğŸ‡¨ğŸ‡º',
  'EUR': 'ğŸ‡ªğŸ‡º',
  'CZK': 'ğŸ‡¨ğŸ‡¿',
  'DJF': 'ğŸ‡©ğŸ‡¯',
  'DOP': 'ğŸ‡©ğŸ‡´',
  'EGP': 'ğŸ‡ªğŸ‡¬',
  'SVC': 'ğŸ‡¸ğŸ‡»',
  'ERN': 'ğŸ‡ªğŸ‡·',
  'ETB': 'ğŸ‡ªğŸ‡¹',
  'FKP': 'ğŸ‡«ğŸ‡°',
  'FJD': 'ğŸ‡«ğŸ‡¯',
  'GMD': 'ğŸ‡¬ğŸ‡²',
  'GEL': 'ğŸ‡¬ğŸ‡ª',
  'GHS': 'ğŸ‡¬ğŸ‡­',
  'GIP': 'ğŸ‡¬ğŸ‡®',
  'GTQ': 'ğŸ‡¬ğŸ‡¹',
  'GNF': 'ğŸ‡¬ğŸ‡³',
  'GYD': 'ğŸ‡¬ğŸ‡¾',
  'HTG': 'ğŸ‡­ğŸ‡¹',
  'HNL': 'ğŸ‡­ğŸ‡³',
  'HKD': 'ğŸ‡­ğŸ‡°',
  'HUF': 'ğŸ‡­ğŸ‡º',
  'ISK': 'ğŸ‡®ğŸ‡¸',
  'IDR': 'ğŸ‡®ğŸ‡©',
  'IRR': 'ğŸ‡®ğŸ‡·',
  'IQD': 'ğŸ‡®ğŸ‡¶',
  'ILS': 'ğŸ‡®ğŸ‡±',
  'JMD': 'ğŸ‡¯ğŸ‡²',
  'JPY': 'ğŸ‡¯ğŸ‡µ',
  'JOD': 'ğŸ‡¯ğŸ‡´',
  'KZT': 'ğŸ‡°ğŸ‡¿',
  'KES': 'ğŸ‡°ğŸ‡ª',
  'GBP': 'ğŸ‡¬ğŸ‡§',
  'KPW': 'ğŸ‡°ğŸ‡µ',
  'KRW': 'ğŸ‡°ğŸ‡·',
  'KWD': 'ğŸ‡°ğŸ‡¼',
  'KGS': 'ğŸ‡°ğŸ‡¬',
  'LAK': 'ğŸ‡±ğŸ‡¦',
  'LBP': 'ğŸ‡±ğŸ‡§',
  'LSL': 'ğŸ‡±ğŸ‡¸',
  'INR': 'ğŸ‡®ğŸ‡³',
  'LRD': 'ğŸ‡±ğŸ‡·',
  'LYD': 'ğŸ‡±ğŸ‡¾',
  'MAD': 'ğŸ‡²ğŸ‡¦',
  'MOP': 'ğŸ‡²ğŸ‡´',
  'MGA': 'ğŸ‡²ğŸ‡¬',
  'MWK': 'ğŸ‡²ğŸ‡¼',
  'MYR': 'ğŸ‡²ğŸ‡¾',
  'MVR': 'ğŸ‡²ğŸ‡»',
  'NOK': 'ğŸ‡³ğŸ‡´',
  'NZD': 'ğŸ‡³ğŸ‡¿',
  'MRU': 'ğŸ‡²ğŸ‡·',
  'MUR': 'ğŸ‡²ğŸ‡º',
  'MXN': 'ğŸ‡²ğŸ‡½',
  'MXV': 'ğŸ‡²ğŸ‡½',
  'MDL': 'ğŸ‡²ğŸ‡©',
  'MNT': 'ğŸ‡²ğŸ‡³',
  'MZN': 'ğŸ‡²ğŸ‡¿',
  'MMK': 'ğŸ‡²ğŸ‡²',
  'NAD': 'ğŸ‡³ğŸ‡¦',
  'NPR': 'ğŸ‡³ğŸ‡µ',
  'NIO': 'ğŸ‡³ğŸ‡®',
  'NGN': 'ğŸ‡³ğŸ‡¬',
  'OMR': 'ğŸ‡´ğŸ‡²',
  'PKR': 'ğŸ‡µğŸ‡°',
  'PAB': 'ğŸ‡µğŸ‡¦',
  'PGK': 'ğŸ‡µğŸ‡¬',
  'PYG': 'ğŸ‡µğŸ‡¾',
  'PEN': 'ğŸ‡µğŸ‡ª',
  'PHP': 'ğŸ‡µğŸ‡­',
  'PLN': 'ğŸ‡µğŸ‡±',
  'USD': 'ğŸ‡ºğŸ‡¸',
  'QAR': 'ğŸ‡¶ğŸ‡¦',
  'MKD': 'ğŸ‡²ğŸ‡°',
  'RON': 'ğŸ‡·ğŸ‡´',
  'RUB': 'ğŸ‡·ğŸ‡º',
  'RWF': 'ğŸ‡·ğŸ‡¼',
  'SHP': 'ğŸ‡¸ğŸ‡­',
  'WST': 'ğŸ‡¼ğŸ‡¸',
  'STN': 'ğŸ‡¸ğŸ‡¹',
  'SAR': 'ğŸ‡¸ğŸ‡¦',
  'RSD': 'ğŸ‡·ğŸ‡¸',
  'SCR': 'ğŸ‡¸ğŸ‡¨',
  'SLE': 'ğŸ‡¸ğŸ‡±',
  'SGD': 'ğŸ‡¸ğŸ‡¬',
  'SBD': 'ğŸ‡¸ğŸ‡§',
  'SOS': 'ğŸ‡¸ğŸ‡´',
  'SSP': 'ğŸ‡¸ğŸ‡¸',
  'LKR': 'ğŸ‡±ğŸ‡°',
  'SDG': 'ğŸ‡¸ğŸ‡©',
  'SRD': 'ğŸ‡¸ğŸ‡·',
  'SZL': 'ğŸ‡¸ğŸ‡¿',
  'SEK': 'ğŸ‡¸ğŸ‡ª',
  'CHE': 'ğŸ‡¨ğŸ‡­',
  'CHW': 'ğŸ‡¨ğŸ‡­',
  'SYP': 'ğŸ‡¸ğŸ‡¾',
  'TWD': 'ğŸ‡¹ğŸ‡¼',
  'TJS': 'ğŸ‡¹ğŸ‡¯',
  'TZS': 'ğŸ‡¹ğŸ‡¿',
  'THB': 'ğŸ‡¹ğŸ‡­',
  'TOP': 'ğŸ‡¹ğŸ‡´',
  'TTD': 'ğŸ‡¹ğŸ‡¹',
  'TND': 'ğŸ‡¹ğŸ‡³',
  'TRY': 'ğŸ‡¹ğŸ‡·',
  'TMT': 'ğŸ‡¹ğŸ‡²',
  'UGX': 'ğŸ‡ºğŸ‡¬',
  'UAH': 'ğŸ‡ºğŸ‡¦',
  'AED': 'ğŸ‡¦ğŸ‡ª',
  'USN': 'ğŸ‡ºğŸ‡¸',
  'UYI': 'ğŸ‡ºğŸ‡¾',
  'UYU': 'ğŸ‡ºğŸ‡¾',
  'UZS': 'ğŸ‡ºğŸ‡¿',
  'VUV': 'ğŸ‡»ğŸ‡º',
  'VEF': 'ğŸ‡»ğŸ‡ª',
  'VED': 'ğŸ‡»ğŸ‡ª',
  'VND': 'ğŸ‡»ğŸ‡³',
  'YER': 'ğŸ‡¾ğŸ‡ª',
  'ZMW': 'ğŸ‡¿ğŸ‡²',
  'ZWL': 'ğŸ‡¿ğŸ‡¼',
  'ZAR': 'ğŸ‡¿ğŸ‡¦'
  };

</script>